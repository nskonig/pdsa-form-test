<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Best Start PDSA Form</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    const ACCENTS = {
      what: '#3b82f6',
      why: '#7c3aed',
      who: '#be185d',
      how: '#ea580c',
      where: '#047857',
      when: '#0f766e',
      refl: '#b91c1c',
      topbar: '#0f766e'
    };

    const QuestionLabel = ({ children, color = '#334155' }) => (
      <div className="mb-4">
        <span
          style={{
            fontFamily: "Calibri, 'Segoe UI', Helvetica, Arial, sans-serif",
            fontSize: "1.9rem",
            fontWeight: 700,
            color
          }}
        >
          {children}
        </span>
      </div>
    );

    const MultiSelectDropdown = ({ label, subtitle, options, color, value, onChange, otherValue, onOtherChange }) => (
      <div className="mb-8 bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
        <QuestionLabel color={color}>{label}</QuestionLabel>
        {subtitle && <p className="text-sm text-slate-600 mb-4">{subtitle}</p>}
        <select
          multiple
          value={value}
          onChange={(e) => {
            const selected = Array.from(e.target.selectedOptions, o => o.value);
            onChange(selected);
          }}
          className="w-full px-4 py-3 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-600 focus:border-teal-600 bg-white text-slate-800"
          style={{ minHeight: "200px" }}
        >
          {options.map(opt => <option key={opt} value={opt}>{opt}</option>)}
        </select>
        <p className="text-sm text-slate-500 mt-2 italic">
          Hold Ctrl (Windows) or Cmd (Mac) to select multiple options
        </p>
        <div className="mt-4">
          <label className="block text-sm font-medium text-slate-700 mb-2">Other (please specify)</label>
          <input
            type="text"
            placeholder="Type here if your option is not listed above"
            value={otherValue}
            onChange={(e) => onOtherChange(e.target.value)}
            className="w-full px-4 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-600 focus:border-teal-600"
          />
        </div>
      </div>
    );

    const TextArea = ({ label, subtitle, placeholder, color, value, onChange }) => (
      <div className="mb-8 bg-white p-6 rounded-lg border border-gray-200 shadow-sm">
        <QuestionLabel color={color}>{label}</QuestionLabel>
        {subtitle && <p className="text-sm text-slate-600 mb-4">{subtitle}</p>}
        <textarea
          value={value}
          onChange={(e) => onChange(e.target.value)}
          placeholder={placeholder}
          rows={5}
          className="w-full px-4 py-3 border border-slate-300 rounded-md focus:ring-2 focus:ring-teal-600 focus:border-teal-600 resize-y placeholder-slate-400 text-slate-800"
        />
      </div>
    );

    function ImprovedPDSAForm() {
      const [formData, setFormData] = useState({
        shortTermOutcome: [],
        shortTermOutcomeOther: '',
        changeCategory: [],
        changeCategoryOther: '',
        whatIdea: '',
        whyReason: '',
        whoTargetGroup: [],
        whoTargetGroupOther: '',
        whoServiceArea: [],
        whoServiceAreaOther: '',
        howSteps: '',
        where: [],
        whereOther: '',
        when: '',
        reflections: ''
      });

      const [submitStatus, setSubmitStatus] = useState({ state: 'idle', message: '' });

      const options = {
        shortTermOutcome: [
          'Relationship-based Practices',
          'Cultural Safety for Aboriginal families',
          'Family Awareness',
          'Active Outreach',
          'Service Continuity',
          'Service Accessibility'
        ],
        changeCategory: [
          'Enhancing administrative practices',
          'Enhancing service delivery and practices',
          'Enhancing partnership, improvement team engagement and collaboration',
          'Supporting and informing ECEC services',
          'Supporting and informing community and health services',
          'Supporting and informing families'
        ],
        whoTargetGroup: [
          'First Nations families and communities',
          'Families from culturally and linguistically diverse (CALD) backgrounds',
          'All families (broadly)',
          'Service teams and providers'
        ],
        whoServiceArea: [
          'MCH',
          'Playgroup programs',
          'Comprehensive service initiatives',
          'Kindergarten registration',
          'Early Start Kindergarten',
          'Kindergarten attendance and readiness',
          'Kindergarten enrichment',
          'Transition into primary school',
          'Emergency Relief and Basic Needs Support',
          'Family welfare and safety'
        ],
        where: [
          'Community setting',
          'Community and Health Services',
          'ECEC Centres',
          'Hub',
          'Library',
          'MCH centres',
          'Online',
          'Primary schools',
          'Supported playgroup site/session'
        ]
      };

      const handleInputChange = (field, value) => setFormData(prev => ({ ...prev, [field]: value }));

      const handleSubmit = async () => {
        setSubmitStatus({ state: 'loading', message: '' });
        const payload = { ...formData, timestamp: new Date().toISOString() };

        try {
          const res = await fetch(
            "https://script.google.com/macros/s/AKfycbwgQsbwe2rFjv5LlKFHTPUhMoJeyhpkUikOEN0jJWyTNjQQnkXeU3nC0K2DB_5MEzpo/exec",
            {
              method: 'POST',
              headers: { 'Content-Type': 'text/plain;charset=UTF-8' },
              body: JSON.stringify(payload)
            }
          );
          if (res.ok) {
            setSubmitStatus({ state: 'success', message: 'Form submitted successfully!' });
            setTimeout(() => {
              setFormData({
                shortTermOutcome: [], shortTermOutcomeOther: '',
                changeCategory: [], changeCategoryOther: '',
                whatIdea: '', whyReason: '',
                whoTargetGroup: [], whoTargetGroupOther: '',
                whoServiceArea: [], whoServiceAreaOther: '',
                howSteps: '', where: [], whereOther: '', when: '', reflections: ''
              });
              setSubmitStatus({ state: 'idle', message: '' });
            }, 2500);
          } else {
            setSubmitStatus({ state: 'error', message: 'Submission failed. Please try again.' });
          }
        } catch (e) {
          setSubmitStatus({ state: 'error', message: 'Network error. Please check your connection and try again.' });
        }
      };

      return (
        <div className="min-h-screen bg-gradient-to-b from-slate-50 to-slate-100">
          <div className="max-w-4xl mx-auto p-6">
 <div className="mb-10 p-8 rounded-lg shadow-md text-white" style={{ background: ACCENTS.topbar }}>
  <h1 className="text-4xl font-bold mb-4">Best Start PDSA Form</h1>
  <p className="text-lg opacity-90 leading-relaxed">
    <strong>Welcome!</strong> This form has been created for Best Start Facilitators in response to what you shared during the focus groups; that you wanted something <em>simpler</em> and <em>more flexible</em> for capturing your PDSA tests.<br/><br/>
    This is just a basic prototype, but you’ll notice you can now select more than one option for the dropdown menus and also type something in <strong>‘Other’</strong> if the options provided don’t quite reflect the work you’re doing.<br/><br/>
    We’ve tried to make this version easy to use, while still keeping enough structure to support shared learning across sites.<br/><br/>
    We’re really open to ideas; this won’t be sent to DE until we’ve heard your feedback and made sure it genuinely works for you.
  </p>
</div>

            <MultiSelectDropdown label="Short Term Outcome" subtitle="Select the outcome areas this test aims to improve."
              options={options.shortTermOutcome} value={formData.shortTermOutcome}
              onChange={(v) => handleInputChange('shortTermOutcome', v)}
              otherValue={formData.shortTermOutcomeOther}
              onOtherChange={(v) => handleInputChange('shortTermOutcomeOther', v)}
              color={ACCENTS.topbar}
            />

            <MultiSelectDropdown label="Change Category" subtitle="The type of work or change you are making."
              options={options.changeCategory} value={formData.changeCategory}
              onChange={(v) => handleInputChange('changeCategory', v)}
              otherValue={formData.changeCategoryOther}
              onOtherChange={(v) => handleInputChange('changeCategoryOther', v)}
              color="#6d28d9"
            />

            <TextArea label="WHAT?" subtitle="The specific idea or activity you are testing."
              placeholder="E.g. Introduce Sunshine Circles at ECEC, Pilot a shared transition meeting between MCH and kinder; trial a new communication notebook; test bilingual flyers for families..."
              value={formData.whatIdea} onChange={(v) => handleInputChange('whatIdea', v)}
              color={ACCENTS.what}
            />

            <TextArea label="WHY?" subtitle="Why are you testing this change?"
              placeholder="E.g. Families reported confusion about registration steps, This will enable us to.., Strengthening relationships..."
              value={formData.whyReason} onChange={(v) => handleInputChange('whyReason', v)}
              color={ACCENTS.why}
            />

            <MultiSelectDropdown label="WHO?" subtitle="Who will benefit or participate in this change?"
              options={options.whoTargetGroup} value={formData.whoTargetGroup}
              onChange={(v) => handleInputChange('whoTargetGroup', v)}
              otherValue={formData.whoTargetGroupOther}
              onOtherChange={(v) => handleInputChange('whoTargetGroupOther', v)}
              color={ACCENTS.who}
            />

            <MultiSelectDropdown label="Service Context" subtitle="Which services or programs are involved?"
              options={options.whoServiceArea} value={formData.whoServiceArea}
              onChange={(v) => handleInputChange('whoServiceArea', v)}
              otherValue={formData.whoServiceAreaOther}
              onOtherChange={(v) => handleInputChange('whoServiceAreaOther', v)}
              color={ACCENTS.who}
            />

            <TextArea label="HOW?" subtitle="What practical steps will you take to make this happen? If another service wished to use your idea, what would they need to know?"
              placeholder="E.g. 'First, we...', Co-design flyers, hold weekly planning huddles..."
              value={formData.howSteps} onChange={(v) => handleInputChange('howSteps', v)}
              color={ACCENTS.how}
            />

            <MultiSelectDropdown label="WHERE?" subtitle="The physical or virtual location(s) where this will happen."
              options={options.where} value={formData.where}
              onChange={(v) => handleInputChange('where', v)}
              otherValue={formData.whereOther}
              onOtherChange={(v) => handleInputChange('whereOther', v)}
              color={ACCENTS.where}
            />

            <TextArea label="WHEN?" subtitle="The timeframe for testing this change."
              placeholder="E.g. Term 1 pilot, one-off event, ongoing..."
              value={formData.when} onChange={(v) => handleInputChange('when', v)}
              color={ACCENTS.when}
            />

            <TextArea label="REFLECTIONS" subtitle="What worked, what didn’t, did anything surprise you, what might you change next time?"
              placeholder="e.g. Families engaged more when sessions were co-facilitated; flyers too text-heavy; next time involve cultural advisor earlier"
              value={formData.reflections} onChange={(v) => handleInputChange('reflections', v)}
              color={ACCENTS.refl}
            />

            <div className="bg-white shadow-md rounded-lg p-8 mt-8">
              <button onClick={handleSubmit} disabled={submitStatus.state === 'loading'}
                className="bg-teal-700 hover:bg-teal-800 text-white font-semibold px-8 py-3 rounded-md transition-colors shadow disabled:bg-gray-400 disabled:cursor-not-allowed">
                {submitStatus.state === 'loading' ? 'Submitting...' : 'Submit'}
              </button>

              {submitStatus.state === 'success' && (
                <div className="mt-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded">
                  {submitStatus.message}
                </div>
              )}
              {submitStatus.state === 'error' && (
                <div className="mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded">
                  {submitStatus.message}
                </div>
              )}
            </div>

            <div className="mt-8 text-center text-sm text-slate-500">
              <p>Best Start Collaboration</p>
              <p className="mt-2">This form is for testing purposes — data is saved to Google Sheets.</p>
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<ImprovedPDSAForm />);
  </script>
</body>
</html>

